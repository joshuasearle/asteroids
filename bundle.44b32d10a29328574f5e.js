(()=>{"use strict";const t=60,i=60,e=400,n=10,o=40,s=500,r=5,h=50,u=200,d=-40,a=40,p=5;var l=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.angle=function(){return 180*Math.atan2(this.y,this.x)/Math.PI},t}();const c=l;var f=function(t,i){return new l(t.x+i.x,t.y+i.y)},y=function(t,i){return new l(t.x*i,t.y*i)},g=function(t,i){var e=Math.PI/180*i;return new l(t*Math.cos(e),t*Math.sin(e))},m=function(i,e,n){var o=y(e,1/t),s=f(i,o);return n&&w(s),s},w=function(t){t.x=t.x%window.innerWidth,t.y=t.y%window.innerHeight,t.x<0&&(t.x=window.innerWidth),t.y<0&&(t.y=window.innerHeight)},v=function(t,i){return(t+i/60/60*360)%360};const I=function(){function t(i,e){this.position=i,this.velocity=g(s,e),this.bulletId=t.nextBulletId,t.nextBulletId+=1}return t.prototype.getIdString=function(){return"bullet"+this.bulletId},t.prototype.tick=function(){this.position=m(this.position,this.velocity,!1)},t.prototype.alive=function(){return!(this.position.x>window.innerWidth||this.position.y>window.innerHeight||this.position.x<0||this.position.y<0)},t.prototype.remove=function(t){var i=document.getElementById(this.getIdString());i&&t.removeChild(i)},t.prototype.createElement=function(t){var i=document.createElementNS(t.namespaceURI,"circle");t.appendChild(i),i.classList.add("bullet"),i.setAttribute("id",this.getIdString()),i.setAttribute("r",String(r))},t.prototype.render=function(t){document.getElementById(this.getIdString())||this.createElement(t);var i=document.getElementById(this.getIdString()),e="translate("+this.position.x+", "+this.position.y+")";i.setAttribute("transform",e)},t.prototype.collidingWith=function(t){var i,e,n=t.getRadius();return(i=t.getPosition(),e=this.position,new l(i.x-e.x,i.y-e.y)).magnitude()<n},t.nextBulletId=0,t}(),E=function(){function t(){this.position=new c(window.innerWidth/2,window.innerHeight/2),this.velocity=new c(0,0),this.rotation=90,this.rpm=0}return t.prototype.tick=function(){this.position=m(this.position,this.velocity,!0),this.rotation=v(this.rotation,this.rpm)},t.prototype.thrust=function(){var t,n,o=g(i,this.rotation),s=new c(o.x,-o.y);this.velocity=f(this.velocity,s),this.velocity.magnitude()<=e||(this.velocity=(t=this.velocity,n=e,y(function(t){var i=t.magnitude();return y(t,1/i)}(t),n)))},t.prototype.turnLeft=function(){this.rpm+=n,this.handleMaxRpm()},t.prototype.turnRight=function(){this.rpm-=n,this.handleMaxRpm()},t.prototype.handleMaxRpm=function(){this.rpm>o?this.rpm=o:this.rpm<-o&&(this.rpm=-o)},t.prototype.shoot=function(){return new I(this.position,-this.rotation)},t.prototype.createElement=function(t){var i=document.createElementNS(t.namespaceURI,"polygon");t.appendChild(i),i.setAttribute("id","ship"),i.setAttribute("points","0,0 0,30 50,15")},t.prototype.render=function(t){document.getElementById("ship")||this.createElement(t);var i=document.getElementById("ship"),e="translate("+(this.position.x-25)+", "+(this.position.y-15)+") rotate("+-this.rotation+" 25 15) ";i.setAttribute("transform",e)},t}();var b=function(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t+1))+t};const x="20,20 35,5 55,20 85,20 90,60 60,70 35,90 10,60 20,40",k="10,10 16,3 26,10 42,10 45,30 30,35 17,45 5,30 10,20",A=function(){function t(i,e){void 0===e&&(e=null),this.small=i,this.velocity=g(b(h,u),b(0,360)),this.position=null===e?new c(window.innerWidth,window.innerHeight):e,this.rotation=0,this.rpm=b(d,a),this.asteroidId=t.nextAsteroidId,t.nextAsteroidId+=1}return t.prototype.getIdString=function(){return"asteroid"+this.asteroidId},t.prototype.getPoints=function(){return this.small?k:x},t.prototype.tick=function(){this.position=m(this.position,this.velocity,!0),this.rotation=v(this.rotation,this.rpm)},t.prototype.createElement=function(t){var i=document.createElementNS(t.namespaceURI,"polygon");t.appendChild(i),i.setAttribute("id",this.getIdString()),i.setAttribute("points",this.getPoints()),i.classList.add("asteroid")},t.prototype.getWidthHeight=function(){return this.small?50:100},t.prototype.render=function(t){document.getElementById(this.getIdString())||this.createElement(t);var i=document.getElementById(this.getIdString()),e="translate("+(this.position.x-this.getWidthHeight()/2)+", "+(this.position.y-this.getWidthHeight()/2)+") rotate("+-this.rotation+" "+this.getWidthHeight()/2+" "+this.getWidthHeight()/2+") ";i.setAttribute("transform",e)},t.prototype.remove=function(t){var i=document.getElementById(this.getIdString());t.removeChild(i)},t.prototype.break=function(){if(this.small)return[];var i=[];return i.push(new t(!0,this.position)),i.push(new t(!0,this.position)),i.push(new t(!0,this.position)),i},t.prototype.getPosition=function(){return this.position},t.prototype.getRadius=function(){return this.getWidthHeight()/2},t.nextAsteroidId=0,t}(),B=function(){function t(){this.resetState(),this.asteroids.push(new A(!1))}return t.prototype.resetState=function(){this.ship=new E,this.paused=!0,this.deadBullets=this.bullets||[],this.bullets=[],this.deadAsteroids=this.asteroids||[],this.asteroids=[],this.tickCount=0},t.prototype.render=function(t){this.ship.render(t),this.bullets.forEach((function(i){return i.render(t)})),this.deadBullets.forEach((function(i){return i.remove(t)})),this.asteroids.forEach((function(i){return i.render(t)})),this.deadAsteroids.forEach((function(i){return i.remove(t)})),this.deadBullets=[],this.deadAsteroids=[],document.getElementById("message").style.visibility=this.paused?"visible":"hidden"},t.prototype.tick=function(){this.ship.tick(),this.bullets.forEach((function(t){return t.tick()})),this.deadBullets=this.bullets.filter((function(t){return!t.alive()})),this.bullets=this.bullets.filter((function(t){return t.alive()})),this.asteroids.forEach((function(t){return t.tick()})),this.tickCount%240==0&&this.asteroids.length<p&&this.asteroids.push(new A(!1)),this.handleCollisions(),this.tickCount+=1},t.prototype.handleCollisions=function(){for(var t=function(t){for(var e=function(e){if(!t.collidingWith(e))return"continue";var n=e.break();i.asteroids=i.asteroids.concat(n),i.deadAsteroids.push(e),i.asteroids=i.asteroids.filter((function(t){return t!==e})),i.deadBullets.push(t),i.bullets=i.bullets.filter((function(i){return i!==t}))},n=0,o=i.asteroids;n<o.length;n++)e(o[n])},i=this,e=0,n=this.bullets;e<n.length;e++)t(n[e])},t.prototype.getPaused=function(){return this.paused},t.prototype.togglePaused=function(){this.paused=!this.paused},t.prototype.inputHandler=function(t){if("ArrowUp"===t.key||"w"===t.key)this.ship.thrust();else if("ArrowLeft"===t.key||"a"===t.key)this.ship.turnLeft();else if("ArrowRight"===t.key||"d"===t.key)this.ship.turnRight();else if(" "===t.key){var i=this.ship.shoot();this.bullets.push(i)}},t}();var S=document.getElementById("svg"),M=new B;M.render(S),setInterval((function(){M.getPaused()||M.tick(),M.render(S)}),1e3/t),window.addEventListener("keydown",(function(t){"Escape"===t.key&&M.togglePaused()})),window.addEventListener("keydown",(function(t){"r"===t.key&&(M.resetState(),M.render(S))})),window.addEventListener("keydown",(function(t){M.getPaused()||M.inputHandler(t)}))})();