(()=>{"use strict";const t=60,e=10,i=400,n=2,o=40,r=500,s=5,h=50,u=200,p=-40,d=40,a=5,c=10,l=25;var f=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.angle=function(){return 180*Math.atan2(this.y,this.x)/Math.PI},t}();const y=f;var g=function(t,e){return new f(t.x+e.x,t.y+e.y)},m=function(t,e){return new f(t.x*e,t.y*e)},w=function(t,e){var i=Math.PI/180*e;return new f(t*Math.cos(i),t*Math.sin(i))},v=function(e,i,n){var o=m(i,1/t),r=g(e,o);return n&&b(r),r},b=function(t){t.x=t.x%window.innerWidth,t.y=t.y%window.innerHeight,t.x<0&&(t.x=window.innerWidth),t.y<0&&(t.y=window.innerHeight)},I=function(t,e){return(t+e/60/60*360)%360};const k=function(){function t(e,i){this.position=e,this.velocity=w(r,i),this.hit=!1,this.bulletId=t.nextBulletId,t.nextBulletId+=1}return t.prototype.getIdString=function(){return"bullet"+this.bulletId},t.prototype.tick=function(){this.position=v(this.position,this.velocity,!1)},t.prototype.alive=function(){return!(this.hit||this.position.x>window.innerWidth||this.position.y>window.innerHeight||this.position.x<0||this.position.y<0)},t.prototype.collided=function(t){t.isAsteroid()&&(this.hit=!0)},t.prototype.remove=function(t){var e=document.getElementById(this.getIdString());e&&t.removeChild(e)},t.prototype.createElement=function(t){var e=document.createElementNS(t.namespaceURI,"circle");t.appendChild(e),e.classList.add("bullet"),e.setAttribute("id",this.getIdString()),e.setAttribute("r",String(s))},t.prototype.render=function(t){document.getElementById(this.getIdString())||this.createElement(t);var e=document.getElementById(this.getIdString()),i="translate("+this.position.x+", "+this.position.y+")";e.setAttribute("transform",i)},t.prototype.getRadius=function(){return s},t.prototype.getPosition=function(){return this.position},t.prototype.isAsteroid=function(){return!1},t.prototype.isBullet=function(){return!0},t.prototype.onDeadReturn=function(){return[]},t.nextBulletId=0,t}(),E=function(){function t(){this.position=new y(window.innerWidth/2,window.innerHeight/2),this.velocity=new y(0,0),this.rotation=90,this.rpm=0,this.dead=!1}return t.prototype.tick=function(){this.position=v(this.position,this.velocity,!0),this.rotation=I(this.rotation,this.rpm)},t.prototype.alive=function(){return!this.dead},t.prototype.thrust=function(){var t,n,o=w(e,this.rotation),r=new y(o.x,-o.y);this.velocity=g(this.velocity,r),this.velocity.magnitude()<=i||(this.velocity=(t=this.velocity,n=i,m(function(t){var e=t.magnitude();return m(t,1/e)}(t),n)))},t.prototype.turnLeft=function(){this.rpm+=n,this.handleMaxRpm()},t.prototype.turnRight=function(){this.rpm-=n,this.handleMaxRpm()},t.prototype.handleMaxRpm=function(){this.rpm>o?this.rpm=o:this.rpm<-o&&(this.rpm=-o)},t.prototype.shoot=function(){return new k(this.position,-this.rotation)},t.prototype.createElement=function(t){var e=document.createElementNS(t.namespaceURI,"polygon");t.appendChild(e),e.setAttribute("id","ship"),e.setAttribute("points","0,0 0,30 50,15")},t.prototype.render=function(t){document.getElementById("ship")||this.createElement(t);var e=document.getElementById("ship"),i="translate("+(this.position.x-25)+", "+(this.position.y-15)+") rotate("+-this.rotation+" 25 15) ";e.setAttribute("transform",i)},t.prototype.getPosition=function(){return this.position},t.prototype.getRadius=function(){return 15},t.prototype.isAsteroid=function(){return!1},t.prototype.isBullet=function(){return!1},t.prototype.collided=function(t){t.isAsteroid()&&(this.dead=!0)},t.prototype.remove=function(t){var e=document.getElementById("ship");e&&t.removeChild(e)},t.prototype.onDeadReturn=function(){return[]},t}();var A=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t};const x="20,20 35,5 55,20 85,20 90,60 60,70 35,90 10,60 20,40",D="10,10 16,3 26,10 42,10 45,30 30,35 17,45 5,30 10,20",j=function(){function t(e,i){void 0===i&&(i=null),this.small=e,this.velocity=w(A(h,u),A(0,360)),this.position=null===i?new y(window.innerWidth,window.innerHeight):i,this.rotation=0,this.rpm=A(p,d),this.asteroidId=t.nextAsteroidId,this.dead=!1,t.nextAsteroidId+=1}return t.prototype.getIdString=function(){return"asteroid"+this.asteroidId},t.prototype.getPoints=function(){return this.small?D:x},t.prototype.tick=function(){this.position=v(this.position,this.velocity,!0),this.rotation=I(this.rotation,this.rpm)},t.prototype.createElement=function(t){var e=document.createElementNS(t.namespaceURI,"polygon");t.appendChild(e),e.setAttribute("id",this.getIdString()),e.setAttribute("points",this.getPoints()),e.classList.add("asteroid")},t.prototype.getWidthHeight=function(){return this.small?50:100},t.prototype.render=function(t){document.getElementById(this.getIdString())||this.createElement(t);var e=document.getElementById(this.getIdString()),i="translate("+(this.position.x-this.getWidthHeight()/2)+", "+(this.position.y-this.getWidthHeight()/2)+") rotate("+-this.rotation+" "+this.getWidthHeight()/2+" "+this.getWidthHeight()/2+") ";e.setAttribute("transform",i)},t.prototype.remove=function(t){var e=document.getElementById(this.getIdString());e&&t.removeChild(e)},t.prototype.break=function(){if(this.small)return[];var e=[];return e.push(new t(!0,this.position)),e.push(new t(!0,this.position)),e.push(new t(!0,this.position)),e},t.prototype.getPosition=function(){return this.position},t.prototype.getRadius=function(){return this.getWidthHeight()/2},t.prototype.isSmall=function(){return this.small},t.prototype.isAsteroid=function(){return!0},t.prototype.isBullet=function(){return!1},t.prototype.collided=function(t){t.isBullet()&&(this.dead=!0)},t.prototype.alive=function(){return!this.dead},t.addAsteroid=function(e,i){return console.log(i,a),e%240==0&&i<a?[new t(!1)]:[]},t.prototype.onDeadReturn=function(t){this.break().forEach((function(e){return t.addAsteroid(e)})),t.addPoints(this.small?c:l)},t.nextAsteroidId=0,t}();const O=function(t,e){(function(t,e){var i,n;return(i=t.getPosition(),n=e.getPosition(),new f(i.x-n.x,i.y-n.y)).magnitude()-t.getRadius()-e.getRadius()<0})(t,e)&&(t.collided(e),e.collided(t))},R=function(){function t(){this.resetState()}return t.prototype.resetState=function(){this.ship=new E,this.deadObjects=this.gameObjects||[],this.gameObjects=[this.ship],this.paused=!0,this.tickCount=0,this.over=!1,this.upDown=!1,this.leftDown=!1,this.rightDown=!1,this.points=0},t.prototype.render=function(t){this.gameObjects.forEach((function(e){return e.render(t)})),this.deadObjects.forEach((function(e){return e.remove(t)})),this.deadObjects=[];var e=document.getElementById("message"),i="Points: "+this.points;this.over?i=i.concat("<br />Press &lt;r&gt; to restart"):this.paused&&(i=i.concat("<br />Press &lt;esc&gt; to unpause")),e.innerHTML=i},t.prototype.getDeadObjects=function(){return this.gameObjects.filter((function(t){return!t.alive()}))},t.prototype.removeDeadObjects=function(){this.deadObjects=this.gameObjects.filter((function(t){return!t.alive()})),this.gameObjects=this.gameObjects.filter((function(t){return t.alive()}))},t.prototype.tick=function(){var t=this;if(!this.paused&&!this.over){this.handleDownKeys(),this.removeDeadObjects(),this.deadObjects.forEach((function(e){e.onDeadReturn(t)})),this.gameObjects.forEach((function(t){return t.tick()}));var e=this.gameObjects.filter((function(t){return t.isAsteroid()})).filter((function(t){return!t.isSmall()})).length;this.gameObjects=this.gameObjects.concat(j.addAsteroid(this.tickCount,e)),this.handleCollisions(),this.ship.alive()||(this.over=!0),this.tickCount+=1}},t.prototype.handleCollisions=function(){for(var t=this.gameObjects,e=0;e<t.length;e++)for(var i=e;i<t.length;i++)O(t[e],t[i])},t.prototype.togglePaused=function(){this.paused=!this.paused},t.prototype.handleDownKeys=function(){this.upDown&&this.ship.thrust(),this.leftDown&&this.ship.turnLeft(),this.rightDown&&this.ship.turnRight()},t.prototype.keyDownHandler=function(t){if(!this.over&&("Escape"===t.key&&(this.paused=!this.paused),!this.paused))if("ArrowUp"===t.key||"w"===t.key)this.upDown=!0;else if("ArrowLeft"===t.key||"a"===t.key)this.leftDown=!0;else if("ArrowRight"===t.key||"d"===t.key)this.rightDown=!0;else if(" "===t.key){var e=this.ship.shoot();this.gameObjects.push(e)}},t.prototype.keyUpHandler=function(t){this.paused||this.over||("ArrowUp"===t.key||"w"===t.key?this.upDown=!1:"ArrowLeft"===t.key||"a"===t.key?this.leftDown=!1:"ArrowRight"!==t.key&&"d"!==t.key||(this.rightDown=!1))},t.prototype.addAsteroid=function(t){this.gameObjects.push(t)},t.prototype.addPoints=function(t){this.points+=t},t}();var S=document.getElementById("svg"),B=new R;B.render(S),setInterval((function(){B.tick(),B.render(S)}),1e3/t),window.addEventListener("keydown",(function(t){"r"===t.key&&(t.repeat||(B.resetState(),B.render(S)))})),window.addEventListener("keydown",(function(t){t.repeat||B.keyDownHandler(t)})),window.addEventListener("keyup",(function(t){B.keyUpHandler(t)}))})();